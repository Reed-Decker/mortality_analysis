X <- group_by(X, ..., Age.Group.Code)
X <- summarise(X, Population = sum(unique(Population)), Deaths = sum(Deaths))
# Calculate crude rate for each age group
X$Crude.Rate <- (X$Deaths * 100000) / X$Population
# Add in the age weights from the age_key dataframe
X <- merge(
X,
age_key[, c("Age.Group.Code", "Age.Weight")],
by = "Age.Group.Code"
)
# Multiply crude rates by age weight and sum across age groups for finished product
X$Age.Adjustment <- X$Age.Weight * X$Crude.Rate
X <- group_by(X, ...)
X <- summarise(X, Crude.Rate.Adjusted = sum(Age.Adjustment))
return(X)
}
death_cause <- c("C00-D48", "I00-I99")
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = ICD.Chapter.Code)) +
geom_line() +
geom_point() +
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(
labels = icd_key$ICD.Chapter[
icd_key$ICD.Chapter.Code %in% death_cause
],
name = "Cause of Death"
)
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code)) +
geom_line() +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender")
death_cause <- total_deaths$ICD.Chapter.Code[
which(
total_deaths$Deaths > 999999 &
total_deaths$Deaths < 10000000
)
]
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = ICD.Chapter.Code)) +
geom_line() +
geom_point(aes(shape = ICD.Chapter.Code)) +
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Common Causes of Death Over Time") +
scale_color_discrete(
labels = icd_key$ICD.Chapter[
icd_key$ICD.Chapter.Code %in% death_cause
],
name = "Cause of Death"
) +
scale_linetype_discrete(
labels = icd_key$ICD.Chapter[
icd_key$ICD.Chapter.Code %in% death_cause
],
name = "Cause of Death"
) +
scale_shape_manual(
labels = icd_key$ICD.Chapter[
icd_key$ICD.Chapter.Code %in% death_cause
],
name = "Cause of Death",
values = c(15, 16, 17, 15, 16, 17, 15, 16)
)
death_cause <- c("F01-F09","G10-G14", "G20-G25", "G30-G31")
filter(df, ICD.Sub.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, ICD.Sub.Chapter.Code, Year) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = ICD.Sub.Chapter.Code)) +
geom_line() +
geom_point() +
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Deaths from Organic Mental Disorders and Nervous System Disorders") +
scale_color_discrete(name = "ICD Sub-Chapters"
)
labels_gender <- c(`F` = "Female", `M` = "Male")
filter(df, ICD.Chapter.Code == "V01-Y98") %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code)) +
facet_wrap(~Gender.Code, labeller = labeller(Gender.Code = labels_gender))+
geom_line() +
geom_point() +
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Deaths from External Causes by Race and Gender") +
scale_color_discrete(labels = race_key$Race, name = "Race")
filter(df, ICD.Chapter.Code == "V01-Y98") %>%
age_adjust(ICD.Sub.Chapter.Code, Year, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = ICD.Sub.Chapter.Code)) +
facet_wrap(~Gender.Code, labeller = labeller(Gender.Code = labels_gender))+
geom_line() +
geom_point() +
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Deaths from External Causes by Race and Gender") +
scale_color_discrete(labels = str_wrap(icd_sub_key$ICD.Sub.Chapter[
icd_sub_key$ICD.Chapter.Code == "V01-Y98"
], 20), name = "Death Cause")
test <- filter(df, ICD.Chapter.Code == "V01-Y98") %>%
age_adjust(ICD.Sub.Chapter.Code, Year, Gender.Code)
View(test)
# Function takes the name of the dataframe, then the name(s) of any grouping variables of interest
age_adjust <- function(X, ...){
# Age.Group.Call needs to be included alongside the specific groups listed in the function call.
X <- group_by(X, ..., Age.Group.Code)
X <- summarise(X, Population = sum(unique(Population)), Deaths = sum(Deaths))
# Calculate crude rate for each age group
X$Crude.Rate <- (X$Deaths * 100000) / X$Population
# # Add in the age weights from the age_key dataframe
# X <- merge(
#
#       X,
#   age_key[, c("Age.Group.Code", "Age.Weight")],
#   by = "Age.Group.Code"
# )
#
# # Multiply crude rates by age weight and sum across age groups for finished product
# X$Age.Adjustment <- X$Age.Weight * X$Crude.Rate
#
# X <- group_by(X, ...)
#
# X <- summarise(X, Crude.Rate.Adjusted = sum(Age.Adjustment))
return(X)
}
test <- filter(df, ICD.Chapter.Code == "V01-Y98") %>%
age_adjust(ICD.Sub.Chapter.Code, Year, Gender.Code)
View(test)
# Function takes the name of the dataframe, then the name(s) of any grouping variables of interest
age_adjust <- function(X, ...){
# Age.Group.Call needs to be included alongside the specific groups listed in the function call.
X <- group_by(X, ..., Age.Group.Code)
X <- summarise(X, Population = sum(unique(Population)), Deaths = sum(Deaths))
# Calculate crude rate for each age group
X$Crude.Rate <- (X$Deaths * 100000) / X$Population
# Add in the age weights from the age_key dataframe
X <- merge(
X,
age_key[, c("Age.Group.Code", "Age.Weight")],
by = "Age.Group.Code"
)
# Multiply crude rates by age weight and sum across age groups for finished product
X$Age.Adjustment <- X$Age.Weight * X$Crude.Rate
X <- group_by(X, ...)
X <- summarise(X, Crude.Rate.Adjusted = sum(Age.Adjustment))
return(X)
}
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
death_cause <- c("C00-D48", "I00-I99")
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code)) +
geom_line() +
geom_point(aes(shape = Gender.Code)) +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender")
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code)) +
geom_line() +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender")
scale_shape_discrete()
?scale_shape_discrete()
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, fill = Race.Code, shape = Gender.Code)) +
geom_line() +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender")
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot() +
geom_line(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code)) +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender")
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot() +
geom_line(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code)) +
geom_point(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code)) +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender")
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot() +
geom_line(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code)) +
geom_point(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code)) +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender")
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot() +
geom_line(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code)) +
geom_point(aes(x = Year, y = Crude.Rate.Adjusted, fill = Race.Code, shape = Gender.Code)) +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender")
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot() +
geom_line(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code, group = Race.Code)) +
geom_point(aes(x = Year, y = Crude.Rate.Adjusted, fill = Race.Code, shape = Gender.Code)) +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender")
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code)) +
geom_line() +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender")
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code)) +
guides(colour=guide_legend(override.aes=list(shape=NA))) +
geom_line() +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender")
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code, linetype = Gender.Code)) +
geom_line() +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender") +
guides(colour=guide_legend(override.aes=list(shape=NA)))
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code, linetype = Gender.Code)) +
geom_line() +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender") +
scale_linetype_manual(labels = gender_key$Gender, name = "Gender", values = c(1, 3))
guides(colour=guide_legend(override.aes=list(shape=NA)))
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code, linetype = Gender.Code)) +
geom_line() +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender") +
scale_linetype_manual(labels = gender_key$Gender, name = "Gender", values = c(1, 5))
guides(colour=guide_legend(override.aes=list(shape=NA)))
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code, linetype = Gender.Code)) +
geom_line() +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender") +
scale_linetype_manual(labels = gender_key$Gender, name = "Gender", values = c(1, 6))
guides(colour=guide_legend(override.aes=list(shape=NA)))
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code, linetype = Gender.Code)) +
geom_line() +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender") +
scale_linetype_manual(labels = gender_key$Gender, name = "Gender", values = c(1, 3))
guides(colour=guide_legend(override.aes=list(shape=NA)))
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code, linetype = Gender.Code)) +
geom_line(aes(size = 2)) +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender") +
scale_linetype_manual(labels = gender_key$Gender, name = "Gender", values = c(1, 3))
guides(colour=guide_legend(override.aes=list(shape=NA)))
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code, linetype = Gender.Code)) +
geom_line(aes(size = 1)) +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender") +
scale_linetype_manual(labels = gender_key$Gender, name = "Gender", values = c(1, 3))
guides(colour=guide_legend(override.aes=list(shape=NA)))
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code, linetype = Gender.Code)) +
geom_line(aes(size = .2)) +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender") +
scale_linetype_manual(labels = gender_key$Gender, name = "Gender", values = c(1, 3))
guides(colour=guide_legend(override.aes=list(shape=NA)))
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code, linetype = Gender.Code)) +
geom_line(aes(size = .02)) +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender") +
scale_linetype_manual(labels = gender_key$Gender, name = "Gender", values = c(1, 3))
guides(colour=guide_legend(override.aes=list(shape=NA)))
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code, linetype = Gender.Code)) +
geom_line(aes(size = 0)) +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender") +
scale_linetype_manual(labels = gender_key$Gender, name = "Gender", values = c(1, 3))
guides(colour=guide_legend(override.aes=list(shape=NA)))
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code, linetype = Gender.Code)) +
geom_line(size = 1) +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender") +
scale_linetype_manual(labels = gender_key$Gender, name = "Gender", values = c(1, 3))
guides(colour=guide_legend(override.aes=list(shape=NA)))
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code, linetype = Gender.Code)) +
geom_line(size = 0.5) +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender") +
scale_linetype_manual(labels = gender_key$Gender, name = "Gender", values = c(1, 3))
guides(colour=guide_legend(override.aes=list(shape=NA)))
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code, linetype = Gender.Code)) +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender") +
scale_linetype_manual(labels = gender_key$Gender, name = "Gender", values = c(1, 3)) +
guides(colour=guide_legend(override.aes=list(shape=NA)))
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code, linetype = Gender.Code)) +
geom_line() +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender") +
scale_linetype_manual(labels = gender_key$Gender, name = "Gender", values = c(1, 3)) +
guides(colour=guide_legend(override.aes=list(shape=NA)))
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code, linetype = Gender.Code)) +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender") +
scale_linetype_manual(labels = gender_key$Gender, name = "Gender", values = c(1, 3)) +
guides(colour=guide_legend(override.aes=list(shape=NA)))
labels_top <- c("Neoplasms", "Circulatory Diseases")
names(labels_top) <- death_cause
filter(df, ICD.Chapter.Code %in% death_cause) %>%
age_adjust(ICD.Chapter.Code, Year, Race.Code, Gender.Code) %>%
ggplot(aes(x = Year, y = Crude.Rate.Adjusted, color = Race.Code, shape = Gender.Code, linetype = Gender.Code)) +
geom_line() +
geom_point() +
facet_wrap(~ICD.Chapter.Code, labeller = labeller(ICD.Chapter.Code = labels_top))+
ylab("Age Adjusted Crude Death Rate") +
labs(title = "Top Causes of Death Over Time") +
scale_color_discrete(labels = race_key$Race, name = "Race") +
scale_shape_discrete(labels = gender_key$Gender, name = "Gender") +
scale_linetype_manual(labels = gender_key$Gender, name = "Gender", values = c(1, 3)) +
guides(colour=guide_legend(override.aes=list(shape=NA)))
?unique()
?merge()
?facet_wrap()
?which()
total_deaths <- df %>%
left_join(icd_key, by = c("ICD.Chapter.Code" = "ICD.Chapter.Code")) %>%
group_by(ICD.Chapter.Code, ICD.Chapter) %>%
summarise(Deaths = sum(Deaths)) %>%
arrange(desc(Deaths))
knitr::kable(total_deaths)
View(age_group_na)
View(year_na)
